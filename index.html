<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Koko Adventure v4.0 - 10 Level Game</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- ELEMEN AUDIO UNTUK BACKGROUND MUSIC -->
    <audio id="backgroundMusic" loop>
        <source src="Upbeat Jungle Music For Media  Cheerful Tribal Theme.mp3" type="audio/mpeg">
        <source src="background-music.ogg" type="audio/ogg">
        Browser Anda tidak mendukung elemen audio.
    </audio>

    <div class="container">
        <header>
            <h1><i class="fas fa-dragon"></i> Koko Adventure </h1>
            <p class="subtitle">10 Level Petualangan di Hutan Ajaib!</p>
        </header>

        <div class="game-container">
            <div class="game-header">
                <div class="stats">
                    <div class="stat">
                        <i class="fas fa-heart"></i>
                        <span id="lives">5</span>
                    </div>
                    <div class="stat">
                        <i class="fas fa-star"></i>
                        <span id="score">0</span>
                    </div>
                    <div class="stat">
                        <i class="fas fa-flag"></i>
                        <span id="level">Level 1/10</span>
                    </div>
                    <div class="stat">
                        <i class="fas fa-clock"></i>
                        <span id="timer">180</span>s
                    </div>
                    <div class="stat">
                        <i class="fas fa-shield-alt"></i>
                        <span id="unlocked">1/10</span>
                    </div>
                </div>
                <div class="controls-info">
                    <span><i class="fas fa-arrow-left"></i> <i class="fas fa-arrow-right"></i> Gerak</span>
                    <span><i class="fas fa-arrow-up"></i> Lompat</span>
                    <span><i class="fas fa-bolt"></i> Serang (Z)</span>
                    <span><i class="fas fa-space-shuttle"></i> Boomerang</span>
                </div>
            </div>

            <canvas id="gameCanvas" width="1000" height="600"></canvas>

            <div class="game-controls">
                <button id="startBtn" class="btn btn-start">
                    <i class="fas fa-play"></i> Mulai Game
                </button>
                <button id="pauseBtn" class="btn btn-pause">
                    <i class="fas fa-pause"></i> Jeda
                </button>
                <button id="resetBtn" class="btn btn-reset">
                    <i class="fas fa-redo"></i> Ulangi Level
                </button>
                <button id="soundBtn" class="btn btn-sound">
                    <i class="fas fa-volume-up"></i> Suara
                </button>
                <button id="fullscreenBtn" class="btn btn-fullscreen">
                    <i class="fas fa-expand"></i> Layar Penuh
                </button>
                <!-- TOMBOL LEVEL BERIKUTNYA -->
                <button id="nextLevelBtn" class="btn btn-next" style="display: none;">
                    <i class="fas fa-forward"></i> Level Berikutnya
                </button>
            </div>

            <!-- LEVEL SELECTOR - DIPERBARUI UNTUK 10 LEVEL -->
            <div class="level-selector">
                <h3><i class="fas fa-layer-group"></i> Pilih Level (Terbuka: <span id="unlockedLevel">1</span>/10):</h3>
                <div class="level-buttons">
                    <!-- Tombol level akan dibuat dinamis oleh JavaScript -->
                    <!-- JavaScript akan membuat tombol untuk 10 level -->
                </div>
            </div>

            <div class="mobile-controls">
                <div class="d-pad">
                    <button id="leftBtn" class="dir-btn"><i class="fas fa-arrow-left"></i></button>
                    <div class="d-pad-center">
                        <button id="upBtn" class="dir-btn"><i class="fas fa-arrow-up"></i></button>
                    </div>
                    <button id="rightBtn" class="dir-btn"><i class="fas fa-arrow-right"></i></button>
                </div>
                <div class="action-buttons">
                    <button id="attackBtn" class="action-btn"><i class="fas fa-bolt"></i></button>
                    <button id="boomerangBtn" class="action-btn boomerang-btn"><i class="fas fa-space-shuttle"></i></button>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h2><i class="fas fa-info-circle"></i> Panduan Game v4.0</h2>
            <div class="instructions-content">
                <div class="instruction">
                    <h3><i class="fas fa-chart-line"></i> 10 Level Petualangan</h3>
                    <p><strong>Level 1-3:</strong> Hutan Dasar<br>
                       <strong>Level 4-6:</strong> Hutan Berbahaya<br>
                       <strong>Level 7-9:</strong> Hutan Legendaris<br>
                       <strong>Level 10:</strong> Pertempuran Akhir</p>
                </div>
                <div class="instruction">
                    <h3><i class="fas fa-gamepad"></i> Kontrol & Item</h3>
                    <p>‚Ä¢ ‚Üê‚Üí : Gerakkan karakter<br>
                       ‚Ä¢ ‚Üë/Spasi/X : Lompat<br>
                       ‚Ä¢ Z : Serang / Lempar Boomerang<br>
                       ‚Ä¢ Kumpulkan item untuk power-up<br>
                       ‚Ä¢ Hindari platform berbahaya</p>
                </div>
                <div class="instruction">
                    <h3><i class="fas fa-trophy"></i> Sistem Progresi</h3>
                    <p>‚Ä¢ Selesaikan level untuk unlock level berikutnya<br>
                       ‚Ä¢ Kalah = ulang level yang sama<br>
                       ‚Ä¢ Bonus skor dari sisa waktu & nyawa<br>
                       ‚Ä¢ Kalahkan bos untuk menang!</p>
                </div>
            </div>
            
            <div class="enemy-guide">
                <h3><i class="fas fa-robot"></i> Jenis Musuh</h3>
                <div class="enemy-list">
                    <div class="enemy-item">
                        <div class="enemy-icon robot"></div>
                        <span>Robot</span>
                    </div>
                    <div class="enemy-item">
                        <div class="enemy-icon snake"></div>
                        <span>Ular</span>
                    </div>
                    <div class="enemy-item">
                        <div class="enemy-icon spider"></div>
                        <span>Laba-laba</span>
                    </div>
                    <div class="enemy-item">
                        <div class="enemy-icon dragon"></div>
                        <span>Naga</span>
                    </div>
                    <div class="enemy-item">
                        <div class="enemy-icon wizard"></div>
                        <span>Penyihir</span>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Koko Adventure v4.0 - 10 Level dengan AI Musuh Tingkat Lanjut</p>
            <p class="hint">Dibuat Oleh Siswa SMKN 2 Surakarta XI PPLG B (Favian,Belvan,Akmal,Kaka)</p>
        </footer>
    </div>

    <!-- Popup untuk Level Complete -->
    <div class="overlay"></div>
    <div class="level-complete-popup">
        <!-- Konten akan diisi oleh JavaScript -->
    </div>

    <script src="game.js"></script>
    <script>
        // =============================================
        // SISTEM SUARA - BACKGROUND MUSIC
        // =============================================
        
        // Inisialisasi variabel suara
        let isSoundEnabled = false;
        const backgroundMusic = document.getElementById('backgroundMusic');
        const soundBtn = document.getElementById('soundBtn');
        
        // Atur volume default (40%)
        backgroundMusic.volume = 0.4;
        
        // Fungsi toggle suara
        function toggleSound() {
            isSoundEnabled = !isSoundEnabled;
            
            if (isSoundEnabled) {
                // Nyalakan musik background
                backgroundMusic.play().catch(error => {
                    console.log("Autoplay diblokir, klik tombol suara lagi");
                    isSoundEnabled = false;
                });
                
                // Update tampilan tombol
                soundBtn.innerHTML = '<i class="fas fa-volume-up"></i> Suara ON';
                console.log("üîä Musik background diaktifkan");
            } else {
                // Matikan musik
                backgroundMusic.pause();
                
                // Update tampilan tombol
                soundBtn.innerHTML = '<i class="fas fa-volume-mute"></i> Suara OFF';
                console.log("üîá Musik background dimatikan");
            }
        }
        
        // Event listener untuk tombol suara
        soundBtn.addEventListener('click', function() {
            console.log("üéµ Tombol suara diklik");
            toggleSound();
        });
        
        // Coba mulai musik secara otomatis jika user telah berinteraksi
        let audioInitialized = false;
        function initAudioOnInteraction() {
            if (!audioInitialized) {
                // Coba mulai musik dengan volume rendah
                backgroundMusic.volume = 0.1;
                backgroundMusic.play().then(() => {
                    console.log("üéµ Musik dimulai otomatis");
                    isSoundEnabled = true;
                    soundBtn.innerHTML = '<i class="fas fa-volume-up"></i> Suara ON';
                    // Kembalikan volume normal setelah dimulai
                    setTimeout(() => {
                        backgroundMusic.volume = 0.4;
                    }, 1000);
                }).catch(error => {
                    console.log("‚ùå Autoplay diblokir, klik tombol suara untuk memulai");
                });
                
                audioInitialized = true;
                // Hapus event listeners setelah dicoba
                document.removeEventListener('click', initAudioOnInteraction);
                document.removeEventListener('keydown', initAudioOnInteraction);
                document.removeEventListener('touchstart', initAudioOnInteraction);
            }
        }
        
        // Tambah event listeners untuk interaksi user
        document.addEventListener('click', initAudioOnInteraction);
        document.addEventListener('keydown', initAudioOnInteraction);
        document.addEventListener('touchstart', initAudioOnInteraction);
        
        // Handle ketika musik selesai (loop otomatis)
        backgroundMusic.addEventListener('ended', function() {
            console.log("üîÑ Musik selesai, memulai ulang...");
            backgroundMusic.currentTime = 0;
            if (isSoundEnabled) {
                backgroundMusic.play();
            }
        });
        
        // Handle error audio - gunakan musik online jika file lokal tidak ada
        backgroundMusic.addEventListener('error', function(e) {
            console.error("‚ùå Error audio:", e);
            
            // Coba gunakan musik online alternatif
            const onlineMusic = 'https://assets.mixkit.co/music/preview/mixkit-game-show-suspense-waiting-667.mp3';
            backgroundMusic.src = onlineMusic;
            backgroundMusic.load();
            
            console.log("üîÑ Mencoba musik online alternatif...");
        });
        
        // =============================================
        // FULLSCREEN FUNCTIONALITY
        // =============================================
        
        document.getElementById('fullscreenBtn').addEventListener('click', function() {
            const canvas = document.getElementById('gameCanvas');
            if (!document.fullscreenElement) {
                if (canvas.requestFullscreen) {
                    canvas.requestFullscreen();
                } else if (canvas.webkitRequestFullscreen) {
                    canvas.webkitRequestFullscreen();
                } else if (canvas.msRequestFullscreen) {
                    canvas.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        });
        
        // Update tombol fullscreen ketika status berubah
        document.addEventListener('fullscreenchange', updateFullscreenButton);
        document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
        document.addEventListener('msfullscreenchange', updateFullscreenButton);
        
        function updateFullscreenButton() {
            const btn = document.getElementById('fullscreenBtn');
            if (document.fullscreenElement || 
                document.webkitFullscreenElement || 
                document.msFullscreenElement) {
                btn.innerHTML = '<i class="fas fa-compress"></i> Keluar Fullscreen';
            } else {
                btn.innerHTML = '<i class="fas fa-expand"></i> Layar Penuh';
            }
        }
        
        // =============================================
        // MOBILE CONTROLS
        // =============================================
        
        document.getElementById('attackBtn').addEventListener('touchstart', function(e) {
            e.preventDefault();
            // Trigger attack
            const event = new KeyboardEvent('keydown', { key: 'z' });
            document.dispatchEvent(event);
        });
        
        document.getElementById('boomerangBtn').addEventListener('touchstart', function(e) {
            e.preventDefault();
            // Trigger boomerang (same as attack for now)
            const event = new KeyboardEvent('keydown', { key: 'z' });
            document.dispatchEvent(event);
        });
        
        console.log("‚úÖ Sistem suara siap digunakan!");
        console.log("üéÆ Tekan tombol 'Suara' untuk mengaktifkan musik background");
    </script>
</body>
</html>